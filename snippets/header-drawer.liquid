{% comment %}
  Renders a header drawer menu for mobile and desktop.

  Usage:
  {% render 'header-drawer' %}
{% endcomment %}
<header-drawer data-breakpoint="{% if section.settings.menu_type_desktop == 'drawer' %}desktop{% else %}tablet{% endif %}">
  <details id="Details-menu-drawer-container" class="menu-drawer-container{% if has_button == true %} hidden-mb{% else %} hidden-pc{% endif %}">
    <summary
      class="header__icon header__icon--menu header__icon--summary link focus-inset"
      aria-label="{{ 'sections.header.menu' | t }}"
    >
      <span>
        {% render 'icon-hamburger' %}
      </span>
    </summary>
    <div id="menu-drawer" class="gradient menu-drawer motion-reduce color-{{ section.settings.menu_color_scheme }}">
      <div class="menu-drawer__inner-container">
        <div class="header-wrapper">
          <a href="{{ routes.root_url }}" class="header__heading-link link link--text focus-inset header__heading">
            {%- if section.settings.logo_type == 'image' -%}
              {%- if section.settings.logo_image != blank -%}
                  <div class="header__heading-logo-wrapper">
                      {%- assign logo_alt = section.settings.logo_image.alt | default: shop.name | escape -%}
                      {%- assign logo_height = section.settings.logo_width | divided_by: section.settings.logo_image.aspect_ratio -%}
                      {% capture sizes %}(min-width: 750px) {{ section.settings.logo_width }}px, 50vw{% endcapture %}
                      {% capture widths %}{{ section.settings.logo_width }}, {{ section.settings.logo_width | times: 1.5 | round }}, {{ section.settings.logo_width | times: 2 }}{% endcapture %}
                      {{ section.settings.logo_image | image_url: width: 600 | image_tag:
                          class: 'header__heading-logo motion-reduce',
                          widths: widths,
                          height: logo_height,
                          width: section.settings.logo_width,
                          alt: logo_alt,
                          sizes: sizes,
                          preload: true
                      }}
                  </div>
              {%- else -%}
                  <span class="h2">{{ shop.name }}</span>
              {%- endif -%}
            {%- else -%}
              {%- if section.settings.logo_text != blank -%}
                  <div class="header__heading-logo-wrapper logo_text">
                      {{ section.settings.logo_text }}
                      </div>
              {%- else -%}
                  <span class="h2">{{ shop.name }}</span>
              {%- endif -%}
            {%- endif -%}
          </a>
          <button
                class="drawer__close"
                type="button"
                aria-label="{{ 'accessibility.close' | t }}"
              >
                {% render 'icon-close' %}
          </button>
        </div>
        
        <div class="menu-drawer__navigation-container">
          <nav class="menu-drawer__navigation">
            <ul class="menu-drawer__menu has-submenu list-menu" role="list">
              {%- for link in section.settings.menu.links -%}
                <li>
                  {%- if link.links != blank -%}
                    <details id="Details-menu-drawer-menu-item-{{ forloop.index }}">
                      <summary
                        id="HeaderDrawer-{{ link.handle }}"
                        class="menu-drawer__menu-item list-menu__item link link--text focus-inset{% if link.child_active %} menu-drawer__menu-item--active{% endif %}"
                      >
                        {{ link.title | escape }}
                        {% render 'icon-caret' %}
                      </summary>
                      <div
                        id="link-{{ link.handle | escape }}"
                        class="menu-drawer__submenu has-submenu gradient motion-reduce"
                        tabindex="-1"
                      >
                        <div class="menu-drawer__inner-submenu">
                          <button class="menu-drawer__close-button link link--text focus-inset" aria-expanded="true">
                            <div>
                              {% render 'icon-caret' %}
                              {{ 'header.label_all' | t }}
                            </div>
                            <span class="sub-menu__title">{{ link.title | escape }}</span>
                          </button>
                          <ul class="menu-drawer__menu list-menu" role="list" tabindex="-1">
                            {%- for childlink in link.links -%}
                              <li>
                                {%- if childlink.links == blank -%}
                                  <a
                                    id="HeaderDrawer-{{ link.handle }}-{{ childlink.handle }}"
                                    href="{{ childlink.url }}"
                                    class="menu-drawer__menu-item link link--text list-menu__item focus-inset{% if childlink.current %} menu-drawer__menu-item--active{% endif %}"
                                    {% if childlink.current %}
                                      aria-current="page"
                                    {% endif %}
                                  >
                                    {{ childlink.title | escape }}
                                  </a>
                                {%- else -%}
                                  <details id="Details-menu-drawer-{{ link.handle }}-{{ childlink.handle }}">
                                    <summary
                                      id="HeaderDrawer-{{ link.handle }}-{{ childlink.handle }}"
                                      class="menu-drawer__menu-item link link--text list-menu__item focus-inset"
                                    >
                                      {{ childlink.title | escape }}
                                      {% render 'icon-caret' %}
                                    </summary>
                                    <div
                                      id="childlink-{{ childlink.handle | escape }}"
                                      class="menu-drawer__submenu has-submenu gradient motion-reduce"
                                    >
                                      <button
                                        class="menu-drawer__close-button link link--text focus-inset"
                                        aria-expanded="true"
                                      >
                                        <div>
                                          {% render 'icon-caret' %}
                                          {{ 'header.label_all' | t }}
                                        </div>
                                        <span class="sub-menu__title">{{ childlink.title | escape }}</span>
                                      </button>
                                      <ul
                                        class="menu-drawer__menu list-menu"
                                        role="list"
                                        tabindex="-1"
                                      >
                                        {%- for grandchildlink in childlink.links -%}
                                          <li>
                                            <a
                                              id="HeaderDrawer-{{ link.handle }}-{{ childlink.handle }}-{{ grandchildlink.handle }}"
                                              href="{{ grandchildlink.url }}"
                                              class="menu-drawer__menu-item link link--text list-menu__item focus-inset{% if grandchildlink.current %} menu-drawer__menu-item--active{% endif %}"
                                              {% if grandchildlink.current %}
                                                aria-current="page"
                                              {% endif %}
                                            >
                                              {{ grandchildlink.title | escape }}
                                            </a>
                                          </li>
                                        {%- endfor -%}
                                      </ul>
                                    </div>
                                  </details>
                                {%- endif -%}
                              </li>
                            {%- endfor -%}
                          </ul>
                        </div>
                      </div>
                    </details>
                  {%- else -%}
                    <a
                      id="HeaderDrawer-{{ link.handle }}"
                      href="{{ link.url }}"
                      class="menu-drawer__menu-item list-menu__item link link--text focus-inset{% if link.current %} menu-drawer__menu-item--active{% endif %}"
                      {% if link.current %}
                        aria-current="page"
                      {% endif %}
                    >
                      {{ link.title | escape }}
                    </a>
                  {%- endif -%}
                </li>
              {%- endfor -%}
            </ul>
          </nav>
          <div class="menu-drawer__utility-links">
            {%- if section.settings.enable_social -%}
              <div class="menu-drawer__social">
                {%- if section.settings.label_social != blank -%}
                  <span class="menu-drawer__social--text inline-richtext">{{- section.settings.label_social -}}</span>
                {%- endif -%}
                <ul class="menu-drawer__list--social" role="list">
                  {%- if section.settings.social_facebook_link != blank -%}
                    <li class="list-social__item">
                      <a href="{{ section.settings.social_facebook_link }}" class="link list-social__link">
                        <span class="icon__facebook icon--social">
                          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9.24091 16V8.70218H11.6895L12.0569 5.85725H9.24091V4.04118C9.24091 3.21776 9.46863 2.65661 10.6507 2.65661L12.156 2.65599V0.111384C11.8957 0.0775563 11.0021 0 9.96212 0C7.79044 0 6.30367 1.32557 6.30367 3.75942V5.85725H3.84766V8.70218H6.30367V16H9.24091Z" fill="currentColor"/>
                          </svg>                      
                        </span>
                        <span class="visually-hidden">{{ 'general.social.links.facebook' | t }}</span>
                      </a>
                    </li>
                  {%- endif -%}
                  {%- if section.settings.social_instagram_link != blank -%}
                    <li class="list-social__item">
                      <a href="{{ section.settings.social_instagram_link }}" class="link list-social__link">
                        <span class="icon__instagram icon--social">
                          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8.00002 5.55469C6.65069 5.55469 5.55469 6.65069 5.55469 8.00002C5.55469 9.34935 6.65069 10.448 8.00002 10.448C9.34935 10.448 10.448 9.34935 10.448 8.00002C10.448 6.65069 9.34935 5.55469 8.00002 5.55469Z" fill="currentColor"/>
                            <path d="M11.6894 1.33301H4.30803C2.66803 1.33301 1.33203 2.66901 1.33203 4.30901V11.6903C1.33203 13.333 2.66803 14.6663 4.30803 14.6663H11.6894C13.332 14.6663 14.6654 13.333 14.6654 11.6903V4.30901C14.6654 2.66901 13.332 1.33301 11.6894 1.33301ZM7.9987 12.3197C5.61736 12.3197 3.6787 10.381 3.6787 7.99967C3.6787 5.61834 5.61736 3.68234 7.9987 3.68234C10.38 3.68234 12.3187 5.61834 12.3187 7.99967C12.3187 10.381 10.38 12.3197 7.9987 12.3197ZM12.4094 4.46634C11.9054 4.46634 11.4947 4.05834 11.4947 3.55434C11.4947 3.05034 11.9054 2.63967 12.4094 2.63967C12.9134 2.63967 13.324 3.05034 13.324 3.55434C13.324 4.05834 12.9134 4.46634 12.4094 4.46634Z" fill="currentColor"/>
                          </svg>                      
                        </span>
                        <span class="visually-hidden">{{ 'general.social.links.facebook' | t }}</span>
                      </a>
                    </li>
                  {%- endif -%}
                  {%- if section.settings.social_twitter_link != blank -%}
                    <li class="list-social__item">
                      <a href="{{ section.settings.social_twitter_link }}" class="link list-social__link">
                        <span class="icon__twitter icon--social">
                          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M14.3859 4.0318C13.9059 4.2398 13.4099 4.3838 12.8819 4.4478C13.4259 4.1278 13.8419 3.6158 14.0339 2.9918C13.5219 3.2958 12.9619 3.5038 12.3699 3.6318C11.8899 3.1198 11.2019 2.7998 10.4499 2.7998C8.99394 2.7998 7.82594 3.9838 7.82594 5.4238C7.82594 5.6318 7.84194 5.8238 7.88994 6.0158C5.71394 5.9198 3.79394 4.8638 2.49794 3.2798C1.56994 4.9438 2.60994 6.3198 3.29794 6.7838C2.88194 6.7838 2.46594 6.6558 2.11394 6.4638C2.11394 7.7598 3.02594 8.8318 4.20994 9.0718C3.95394 9.1518 3.37794 9.1998 3.02594 9.1198C3.36194 10.1598 4.33794 10.9278 5.47394 10.9438C4.57794 11.6478 3.26594 12.2078 1.58594 12.0318C2.75394 12.7838 4.12994 13.2158 5.61794 13.2158C10.4499 13.2158 13.0739 9.2158 13.0739 5.7598C13.0739 5.6478 13.0739 5.5358 13.0579 5.4238C13.6019 5.0238 14.0499 4.5598 14.3859 4.0318Z" fill="currentColor"/>
                          </svg>
                        </span>
                        <span class="visually-hidden">{{ 'general.social.links.facebook' | t }}</span>
                      </a>
                    </li>
                  {%- endif -%}
                </ul>
              </div>
            {%- endif -%}
            {%- if localization.available_countries or localization.available_languages -%}
              <div class="menu-drawer__localization header-localization">
                {%- if localization.available_countries and localization.available_countries.size > 1 -%}
                  <noscript>
                    {%- form 'localization', id: 'HeaderCountryMobileFormNoScriptDrawer', class: 'localization-form' -%}
                      <div class="localization-form__select">
                        <h2 id="HeaderCountryMobileLabelNoScriptDrawer">
                          {{ 'localization.country_label' | t }}
                        </h2>
                        <select
                          class="localization-selector link"
                          name="country_code"
                          aria-labelledby="HeaderCountryMobileLabelNoScriptDrawer"
                        >
                          {%- for country in localization.available_countries -%}
                            <option
                              value="{{ country.iso_code }}"
                              {%- if country.iso_code == localization.country.iso_code %}
                                selected
                              {% endif %}
                            >
                              {{ country.name }} ({{ country.currency.iso_code }}
                              {{ country.currency.symbol }})
                            </option>
                          {%- endfor -%}
                        </select>
                        {% render 'icon-caret' %}
                      </div>
                      <button class="button button--tertiary">{{ 'localization.update_country' | t }}</button>
                    {%- endform -%}
                  </noscript>

                  <localization-form class="no-js-hidden">
                    {%- form 'localization', id: 'HeaderCountryMobileForm', class: 'localization-form' -%}
                      <div>
                        <h2 id="HeaderCountryMobileLabel">
                          {{ 'localization.country_label' | t }}
                        </h2>
                        {%- render 'country-localization', localPosition: 'HeaderCountryMobile' -%}
                      </div>
                    {%- endform -%}
                  </localization-form>
                {% endif %}

                {%- if localization.available_languages and localization.available_languages.size > 1 -%}
                  <noscript>
                    {%- form 'localization',
                      id: 'HeaderLanguageMobileFormNoScriptDrawer',
                      class: 'localization-form'
                    -%}
                      <div class="localization-form__select">
                        <h2 id="HeaderLanguageMobileLabelNoScriptDrawer">
                          {{ 'localization.language_label' | t }}
                        </h2>
                        <select
                          class="localization-selector link"
                          name="locale_code"
                          aria-labelledby="HeaderLanguageMobileLabelNoScriptDrawer"
                        >
                          {%- for language in localization.available_languages -%}
                            <option
                              value="{{ language.iso_code }}"
                              lang="{{ language.iso_code }}"
                              {%- if language.iso_code == localization.language.iso_code %}
                                selected
                              {% endif %}
                            >
                              {{ language.endonym_name | capitalize }}
                            </option>
                          {%- endfor -%}
                        </select>
                        {% render 'icon-caret' %}
                      </div>
                      <button class="button button--tertiary">{{ 'localization.update_language' | t }}</button>
                    {%- endform -%}
                  </noscript>

                  <localization-form class="no-js-hidden">
                    {%- form 'localization', id: 'HeaderLanguageMobileForm', class: 'localization-form' -%}
                      <div>
                        <h2 id="HeaderLanguageMobileLabel">
                          {{ 'localization.language_label' | t }}
                        </h2>
                        {%- render 'language-localization', localPosition: 'HeaderLanguageMobile' -%}
                      </div>
                    {%- endform -%}
                  </localization-form>
                {%- endif -%}
              </div>
            {%- endif -%}
          </div>
        </div>
      </div>
    </div>
  </details>
</header-drawer>
